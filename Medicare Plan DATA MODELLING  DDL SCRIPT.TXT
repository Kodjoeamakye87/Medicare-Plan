CREATE TABLE DIM_DRG_Information
( 
	DRG                  varchar(20)  NOT NULL ,
	DIAGNOSIS_RELATED_GROUP_DESCRIPTION varchar(200)  NOT NULL ,
	MAJOR_DIAGNOSTIC_CATEGORY varchar(20)  NOT NULL ,
	MAJOR_DIAGNOSTIC_CATEGORY_DESCRIPTION varchar(500)  NULL 
)
go



ALTER TABLE DIM_DRG_Information
	ADD  PRIMARY KEY  CLUSTERED (DRG ASC)
go



CREATE TABLE DIM_Health_Systems
( 
	HEALTH_SYSTEM_DIM_KEY varchar(20)  NOT NULL ,
	TORCH_HEALTH_SYSTEM_ID integer  NULL ,
	NAME                 varchar(500)  NULL ,
	ADDRESS_LINE_1       varchar(100)  NULL ,
	ADDRESS_LINE_2       varchar(100)  NULL ,
	CITY                 varchar(20)  NULL ,
	STATE                varchar(20)  NULL ,
	ZIP                  integer  NULL ,
	PHONE                integer  NULL ,
	WEBSITE              varchar(20)  NULL 
)
go



ALTER TABLE DIM_Health_Systems
	ADD  PRIMARY KEY  CLUSTERED (HEALTH_SYSTEM_DIM_KEY ASC)
go



CREATE TABLE DIM_Hospital
( 
	HOSPITAL_DIM_KEY     varchar(20)  NOT NULL ,
	TORCH_HOSPITAL_ID    varchar(20)  NULL ,
	PROVIDER_NUMBER      integer  NULL ,
	HOSPITAL_TYPE        varchar  NULL ,
	ZIP                  varchar(20)  NULL ,
	NAME                 varchar(20)  NULL ,
	ADDRESS_LINE_1       varchar(20)  NULL ,
	ADDRESS_LINE_2       varchar(20)  NULL ,
	CITY                 varchar(20)  NULL ,
	STATE                varchar(20)  NULL ,
	COUNTY_NAME          varchar(20)  NULL ,
	HOSPITAL_OWNERSHIP   varchar(20)  NULL ,
	PHONE                integer  NULL ,
	FORMERLY_KNOWN_AS    varchar(200)  NULL ,
	DEACTIVATED_0_1_FLAG bit  NULL ,
	CLOSED_DATE          datetime  NULL ,
	CLOSED_0_1_FLAG      bit  NULL ,
	PRIMARY_EHR_PRODUCT_NAME varchar(100)  NULL ,
	PRIMARY_EHR_PRODUCT_VERSION_NUMBER varchar(20)  NULL ,
	PRIMARY_EHR_PRODUCT_VERSION varchar(20)  NULL ,
	SUPPRESSION_0_1_FLAG bit  NULL 
)
go



ALTER TABLE DIM_Hospital
	ADD  PRIMARY KEY  CLUSTERED (HOSPITAL_DIM_KEY ASC)
go



CREATE TABLE DIM_Hospital_Health_Systems_Affiliations
( 
	HOSPITAL_HEALTH_SYSTEM_HOSPITAL_HOSPITAL_KEY varchar(20)  NOT NULL ,
	HEALTH_SYSTEM_DIM_KEY varchar(20)  NOT NULL ,
	TORCH_HEALTH_SYSTEM_ID varchar(20)  NULL ,
	TORCH_HOSPITAL_ID    integer  NULL ,
	TYPE                 integer  NULL ,
	EFFECTIVE_BEGIN      datetime  NULL ,
	EFFECTIVE_END        datetime  NULL 
)
go



ALTER TABLE DIM_Hospital_Health_Systems_Affiliations
	ADD  PRIMARY KEY  CLUSTERED (HOSPITAL_HEALTH_SYSTEM_HOSPITAL_HOSPITAL_KEY ASC,HEALTH_SYSTEM_DIM_KEY ASC)
go



CREATE TABLE FACT_Episodes_of_Care
( 
	HOSPITAL_EPISODES_OF_CARE_BY_DRG_FACT_KEY varchar(20)  NOT NULL ,
	HOSPITAL_DIM_KEY     varchar(20)  NOT NULL ,
	DRG                  varchar(20)  NOT NULL ,
	YEAR_KEY             varchar(20)  NOT NULL ,
	COUNT_OF_EPISODES    integer  NOT NULL ,
	AVERAGE_AMOUNT_PAID_BY_MEDICARE_FOR_HOME_HEALTH money  NOT NULL ,
	AVERAGE_AMOUNT_PAID_BY_MEDICARE_FOR_HOSPICE money  NULL ,
	AVERAGE_AMOUNT_PAID_BY_MEDICARE_FOR_HOSPITAL money  NULL ,
	AVERAGE_AMOUNT_CHARGED_BY_FACILITY_FOR_REHAB money  NULL ,
	AVERAGE_AMOUNT_PAID_BY_MEDICARE_FOR_SNF money  NULL ,
	AVERAGE_AMOUNT_PAID_BY_MEDICARE_FOR_SUBSEQUENT_HOSPITALIZATION money  NULL ,
	AVERAGE_LENGTH_OF_STAY_FOR_HOME_HEALTH integer  NULL ,
	AVERAGE_LENGTH_OF_STAY_FOR_HOSPICE integer  NULL ,
	AVERAGE_LENGTH_OF_STAY_FOR_HOSPITAL integer  NULL ,
	AVERAGE_LENGTH_OF_STAY_FOR_REHAB integer  NULL ,
	AVERAGE_LENGTH_OF_STAY_FOR_SNF integer  NULL ,
	AVERAGE_LENGTH_OF_STAY_FOR_SUBSEQUENT_HOSPITALIZATION integer  NULL 
)
go



ALTER TABLE FACT_Episodes_of_Care
	ADD  PRIMARY KEY  CLUSTERED (HOSPITAL_EPISODES_OF_CARE_BY_DRG_FACT_KEY ASC,HOSPITAL_DIM_KEY ASC,DRG ASC)
go



CREATE TABLE FACT_Hospital_Beds
( 
	HOSPITAL_COST_REPORT_BEDS_FACT_KEY varchar(20)  NOT NULL ,
	HOSPITAL_DIM_KEY     varchar(20)  NOT NULL ,
	YEAR_KEY             varchar(20)  NULL ,
	BURN_ICU_BEDS        integer  NULL ,
	CORONARY_CARE_BEDS   integer  NULL ,
	HOSPICE_BEDS         integer  NULL ,
	INTENSIVE_CARE_BEDS  integer  NULL ,
	NURSING_FACILITY_BEDS integer  NULL ,
	OTHER_LONG_TERM_CARE_BEDS integer  NULL ,
	OTHER_SPECIAL_CARE_BEDS integer  NULL ,
	SKILLED_NURSING_FACILITY_BEDS integer  NULL ,
	SURGICAL_INTENSIVE_CARE_BEDS integer  NULL ,
	LABOR_AND_DELIVERY_BEDS integer  NULL ,
	SUBPROVIDER_IPF_BEDS integer  NULL ,
	SUBPROVIDER_IRF_BEDS integer  NULL ,
	SUBPROVIDER_OTHER_BEDS integer  NULL ,
	HOSPITAL_ADULT_PEDS_BEDS integer  NULL ,
	INPATIENT_TOTAL_BEDS integer  NULL 
)
go



ALTER TABLE FACT_Hospital_Beds
	ADD  PRIMARY KEY  CLUSTERED (HOSPITAL_COST_REPORT_BEDS_FACT_KEY ASC,HOSPITAL_DIM_KEY ASC)
go



CREATE TABLE FACT_Hospital_Discharges
( 
	HOSPITAL_COST_REPORT_DISCHARGES_FACT_KEY integer  NOT NULL ,
	HOSPITAL_DIM_KEY     varchar(20)  NOT NULL ,
	YEAR_KEY             integer  NULL ,
	TITLE_V_DISCHARGES   varchar(100)  NULL ,
	MEDICARE_DISCHARGES  integer  NULL ,
	MEDICAID_DISCHARGES  integer  NULL ,
	TOTAL_DISCHARGES     integer  NULL ,
	TITLE_V_HOSPITAL_ADULT_PEDS_DISCHARGES varchar(20)  NULL ,
	MEDICARE_HOSPITAL_ADULT_PEDS_DISCHARGES integer  NULL ,
	MEDICAID_HOSPITAL_ADULT_PEDS_DISCHARGES integer  NULL ,
	TOTAL_HOSPITAL_ADULT_PEDS_DISCHARGES integer  NULL ,
	TITLE_V_SUBPROVIDER_IPF_DISCHARGES integer  NULL ,
	MEDICARE_SUBPROVIDER_IPF_DISCHARGES integer  NULL ,
	MEDICAID_SUBPROVIDER_IPF_DISCHARGES integer  NULL ,
	TOTAL_SUBPROVIDER_IPF_DISCHARGES integer  NULL ,
	TITLE_V_SUBPROVIDER_IRF_DISCHARGES varchar(20)  NULL ,
	MEDICARE_SUBPROVIDER_IRF_DISCHARGES integer  NULL ,
	MEDICAID_SUBPROVIDER_IRF_DISCHARGES integer  NULL ,
	TOTAL_SUBPROVIDER_IRF_DISCHARGES integer  NULL ,
	MEDICARE_SUBPROVIDER_OTHER_DISCHARGES integer  NULL ,
	MEDICAID_SUBPROVIDER_OTHER_DISCHARGES integer  NULL ,
	TOTAL_SUBPROVIDER_OTHER_DISCHARGES char(18)  NULL ,
	MEDICARE_HMO_DISCHARGES integer  NULL ,
	OTHER_LONG_TERM_CARE_DISCHARGES integer  NULL ,
	TITLE_V_SUBPROVIDER_OTHER_DISCHARGES varchar  NULL 
)
go



ALTER TABLE FACT_Hospital_Discharges
	ADD  PRIMARY KEY  CLUSTERED (HOSPITAL_COST_REPORT_DISCHARGES_FACT_KEY ASC,HOSPITAL_DIM_KEY ASC)
go



CREATE TABLE FACT_Hospital_revenue
( 
	HOSPITAL_COST_REPORT_TOTAL_REVENUE_FACT_KEY varchar(20)  NOT NULL ,
	HOSPITAL_DIM_KEY     varchar(20)  NOT NULL ,
	YEAR_KEY             integer  NULL ,
	HOSPITAL_GENERAL_REVENUE money  NULL ,
	SUBPROVIDER_IPF_REVENUE money  NULL ,
	SUBPROVIDER_IRF_REVENUE money  NULL ,
	SUBPROVIDER_OTHER_REVENUE money  NULL ,
	SWING_BED_SNF_REVENUE money  NULL ,
	SWING_BED_NF_REVENUE money  NULL ,
	SKILLED_NURSING_FACILITY_REVENUE money  NULL ,
	NURSING_FACILITY_REVENUE money  NULL ,
	OTHER_LONG_TERM_CARE_REVENUE money  NULL ,
	GENERAL_CARE_SERVICES_REVENUE money  NULL ,
	INTENSIVE_CARE_UNIT_REVENUE money  NULL ,
	CORONARY_CARE_UNIT_REVENUE money  NULL ,
	BURN_INTENSIVE_CARE_UNIT_REVENUE money  NULL ,
	SURGICAL_INTENSIVE_CARE_UNIT_REVENUE money  NULL ,
	INTENSIVE_CARE_SERVICES_REVENUE money  NULL ,
	INPATIENT_ROUTINE_CARE_REVENUE money  NULL ,
	ANCILLARY_SERVICES_REVENUE money  NULL ,
	OUTPATIENT_SERVICES_REVENUE money  NULL ,
	RURAL_HEALTH_CLINIC_REVENUE money  NULL ,
	FEDERALLY_QUALIFIED_HEALTH_CENTER_REVENUE money  NULL ,
	HOME_HEALTH_AGENCY_REVENUE money  NULL ,
	AMBULANCE_REVENUE    money  NULL ,
	REHABILITATION_PROVIDERS_REVENUE money  NULL ,
	AMBULATORY_SURGICAL_CENTER_REVENUE money  NULL ,
	HOSPICE_REVENUE      money  NULL ,
	OTHER_REVENUE        money  NULL ,
	TOTAL_PATIENT_REVENUE money  NULL ,
	CONTRACTUAL_ALLOWANCES_DISCOUNTS money  NULL ,
	NET_PATIENT_REVENUE  money  NULL ,
	NET_INCOME_FROM_SERVICE_TO_PATIENTS money  NULL 
)
go



ALTER TABLE FACT_Hospital_revenue
	ADD  PRIMARY KEY  CLUSTERED (HOSPITAL_COST_REPORT_TOTAL_REVENUE_FACT_KEY ASC,HOSPITAL_DIM_KEY ASC)
go



CREATE TABLE FACT_Hospital_Value_Based_Purchasing_Program_Data
( 
	VALUE_BASED_PURCHASING_FACT_KEY varchar(20)  NOT NULL ,
	HOSPITAL_DIM_KEY     varchar(20)  NOT NULL ,
	YEAR_KEY             varchar(20)  NULL ,
	WEIGHTED_CLINICAL_PROCESS_OF_CARE_DOMAIN_SCORE integer  NULL ,
	WEIGHTED_PATIENT_EXPERIENCE_OF_CARE_DOMAIN_SCORE integer  NULL ,
	WEIGHTED_EFFICIENCY_DOMAIN_SCORE integer  NULL ,
	TOTAL_PERFORMANCE_SCORE integer  NULL ,
	ACTUAL_FY_HOSPITAL_VBP_ADJUSTMENT_FACTOR integer  NULL ,
	ESTIMATED_VBP_ADJUSTMENT_DOLLAR_VALUE money  NULL 
)
go



ALTER TABLE FACT_Hospital_Value_Based_Purchasing_Program_Data
	ADD  PRIMARY KEY  CLUSTERED (VALUE_BASED_PURCHASING_FACT_KEY ASC,HOSPITAL_DIM_KEY ASC)
go




ALTER TABLE DIM_Hospital_Health_Systems_Affiliations
	ADD  FOREIGN KEY (HEALTH_SYSTEM_DIM_KEY) REFERENCES DIM_Health_Systems(HEALTH_SYSTEM_DIM_KEY)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE FACT_Episodes_of_Care
	ADD  FOREIGN KEY (HOSPITAL_DIM_KEY) REFERENCES DIM_Hospital(HOSPITAL_DIM_KEY)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE FACT_Episodes_of_Care
	ADD  FOREIGN KEY (DRG) REFERENCES DIM_DRG_Information(DRG)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE FACT_Hospital_Beds
	ADD  FOREIGN KEY (HOSPITAL_DIM_KEY) REFERENCES DIM_Hospital(HOSPITAL_DIM_KEY)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE FACT_Hospital_Discharges
	ADD  FOREIGN KEY (HOSPITAL_DIM_KEY) REFERENCES DIM_Hospital(HOSPITAL_DIM_KEY)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE FACT_Hospital_revenue
	ADD  FOREIGN KEY (HOSPITAL_DIM_KEY) REFERENCES DIM_Hospital(HOSPITAL_DIM_KEY)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go




ALTER TABLE FACT_Hospital_Value_Based_Purchasing_Program_Data
	ADD  FOREIGN KEY (HOSPITAL_DIM_KEY) REFERENCES DIM_Hospital(HOSPITAL_DIM_KEY)
		ON DELETE NO ACTION
		ON UPDATE NO ACTION
go


